{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useContext, useEffect, useState } from \"react\";\nimport ImagePicker from \"@/components/ImagePicker\";\nimport FormInput from \"@/components/FormInput\";\nimport { API, CATEGORIES_TYPES, EMPTY_OFFER } from \"helper/CONST\";\nimport FormSelect2 from \"../FormSelect2\";\nimport MainCardBody from \"./MainCardBody\";\nimport isMissingSomething from \"helper/isMissingSomething\";\nimport HelperContext from \"@/contexts/HelperContext\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport SwiperCore, { Navigation } from \"swiper\";\nimport ImagePicker2 from \"../ImagePicker2\";\nimport Axios from \"axios\";\n\nconst OffersCard = ({\n  item,\n  handleDelete,\n  handleEdit,\n  handleAdd,\n  loader\n}) => {\n  var _info$Product_Images;\n\n  const {\n    0: info,\n    1: setInfo\n  } = useState(_objectSpread({}, EMPTY_OFFER));\n  const {\n    categories\n  } = useContext(HelperContext);\n  const {\n    0: imageLoader,\n    1: setImageLoader\n  } = useState(false);\n  SwiperCore.use([Navigation]);\n  useEffect(() => {\n    if (item) setInfo(_objectSpread({}, item));\n  }, []);\n\n  const handleChange = (id, value) => {\n    setInfo(_objectSpread(_objectSpread({}, info), {}, {\n      [id]: value\n    }));\n  };\n\n  const handleImageChange = (id, value, valueObj) => {\n    setInfo(_objectSpread(_objectSpread({}, info), {}, {\n      [id]: value,\n      [`${id}_obj`]: valueObj\n    }));\n  };\n\n  const handleAddImage = async (image, imageObj) => {\n    if (imageObj) {\n      setImageLoader(true);\n      const formData = new FormData();\n      formData.append(\"image\", imageObj);\n      formData.append(\"offer_id\", item.id);\n\n      try {\n        const res = await Axios({\n          baseURL: API,\n          url: \"/api/offer/images\",\n          method: \"POST\",\n          data: formData\n        });\n        setInfo(_objectSpread(_objectSpread({}, info), {}, {\n          Product_Images: [...res.data.data]\n        }));\n      } catch (error) {\n        console.log(error.response);\n        alert(\"فشل الاضافه\");\n      }\n\n      setImageLoader(false);\n    }\n  };\n\n  const handleRemoveImage = async image => {\n    setImageLoader(true);\n\n    try {\n      const res = await Axios({\n        baseURL: API,\n        url: \"/api/offer/images\",\n        method: \"DELETE\",\n        params: {\n          id: image.id\n        }\n      });\n      console.log(res);\n      setInfo(_objectSpread(_objectSpread({}, info), {}, {\n        Product_Images: [...res.data.data]\n      }));\n    } catch (error) {\n      console.log(error.response);\n      alert(\"فشل المسح\");\n    }\n\n    setImageLoader(false);\n  };\n\n  const onHandleEdit = handleEdit ? () => {\n    const formdata = new FormData();\n\n    if (info.id) {\n      formdata.append(\"id\", info.id);\n    }\n\n    formdata.append(\"name\", info.name);\n    formdata.append(\"price\", info.price); // formdata.append(\"sale_price\", info.sale_price);\n\n    formdata.append(\"description\", info.description); // formdata.append(\"type\", info.type);\n    // formdata.append(\"parent_id\", info.parent_id);\n    // formdata.append(\"category_id\", info.category_id);\n\n    if (info.image_obj) {\n      formdata.append(\"image\", info.image_obj);\n    }\n\n    if (!isMissingSomething(info, [\"sale_price\", \"type\"])) handleEdit(formdata);\n  } : null;\n  const onHandleAdd = handleAdd ? () => {\n    const formdata = new FormData();\n\n    if (info.id) {\n      formdata.append(\"id\", info.id);\n    }\n\n    formdata.append(\"name\", info.name);\n    formdata.append(\"price\", info.price); // formdata.append(\"sale_price\", info.sale_price);\n\n    formdata.append(\"description\", info.description); // formdata.append(\"type\", info.type);\n    // formdata.append(\"parent_id\", info.parent_id);\n    // formdata.append(\"category_id\", info.category_id);\n\n    if (info.image_obj) {\n      formdata.append(\"image\", info.image_obj);\n    }\n\n    if (!isMissingSomething(info, [\"sale_price\", \"type\"])) handleAdd(formdata);\n  } : null;\n\n  const handleChooseCategory = (id, v) => {\n    let [c] = CATEGORIES_TYPES.filter(i => i.value == v);\n    setInfo(_objectSpread(_objectSpread({}, info), {}, {\n      parent_id: c.id,\n      [id]: v\n    }));\n  };\n\n  console.log(info);\n  return /*#__PURE__*/_jsx(MainCardBody, {\n    handleAdd: onHandleAdd,\n    handleEdit: onHandleEdit,\n    handleDelete: handleDelete,\n    item: item ? item : null,\n    loader: loader,\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-col space-y-8\",\n      children: [/*#__PURE__*/_jsx(ImagePicker, {\n        className: \"flex justify-center mb-5\",\n        data: info[\"image\"],\n        id: \"image\",\n        setData: (v, vObj) => handleImageChange(\"image\", v, vObj)\n      }), (item === null || item === void 0 ? void 0 : item.id) && /*#__PURE__*/_jsx(\"div\", {\n        className: \"w-full\",\n        children: /*#__PURE__*/_jsxs(Swiper, {\n          navigation: true,\n          slidesPerView: 1,\n          children: [/*#__PURE__*/_jsx(SwiperSlide, {\n            children: /*#__PURE__*/_jsx(ImagePicker2, {\n              className: \"flex justify-center mb-5\",\n              data: \"\",\n              handleAddImage: handleAddImage,\n              imageLoader: imageLoader\n            })\n          }), info === null || info === void 0 ? void 0 : (_info$Product_Images = info.Product_Images) === null || _info$Product_Images === void 0 ? void 0 : _info$Product_Images.map((image, index) => /*#__PURE__*/_jsx(SwiperSlide, {\n            children: /*#__PURE__*/_jsx(ImagePicker2, {\n              className: \"flex justify-center mb-5\",\n              data: image,\n              handleRemoveImage: handleRemoveImage,\n              imageLoader: imageLoader\n            })\n          }, index))]\n        })\n      }), /*#__PURE__*/_jsx(FormInput, {\n        required: true,\n        name: \"\\u0627\\u0644\\u0627\\u0633\\u0645\",\n        value: info[\"name\"],\n        changeVlaue: v => handleChange(\"name\", v)\n      }), /*#__PURE__*/_jsx(FormInput, {\n        required: true,\n        name: \"\\u0627\\u0644\\u0633\\u0639\\u0631\",\n        type: \"number\",\n        value: info[\"price\"],\n        changeVlaue: v => handleChange(\"price\", v)\n      }), /*#__PURE__*/_jsx(FormInput, {\n        required: true,\n        name: \"\\u0627\\u0644\\u0648\\u0635\\u0641\",\n        value: info[\"description\"],\n        changeVlaue: v => handleChange(\"description\", v),\n        type: \"textarea\",\n        rows: 3\n      })]\n    })\n  });\n};\n\nexport default OffersCard;","map":null,"metadata":{},"sourceType":"module"}