{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { API } from \"helper/CONST\";\nimport React, { useState, useEffect } from \"react\";\nimport Axios from \"axios\";\nimport Cookies from \"js-cookie\"; // create new react context and export it\n\nvar HelperContext = /*#__PURE__*/React.createContext();\nexport default HelperContext;\nexport var HelperContextProvider = function HelperContextProvider(_ref) {\n  var children = _ref.children;\n\n  // create new states\n  var _useState = useState({\n    product: [],\n    service: [],\n    all: []\n  }),\n      categories = _useState[0],\n      setCategories = _useState[1];\n\n  var _useState2 = useState(false),\n      mainLoader = _useState2[0],\n      setMainLoader = _useState2[1];\n\n  var _useState3 = useState([]),\n      ordersItems = _useState3[0],\n      setOrdersItems = _useState3[1];\n\n  var _useState4 = useState(false),\n      newOrdersIndi = _useState4[0],\n      setNewOrdersIndi = _useState4[1];\n\n  var _useState5 = useState({}),\n      userInfo = _useState5[0],\n      setUserInfo = _useState5[1];\n\n  var getCategories = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var values,\n          all,\n          product,\n          service,\n          names,\n          subs,\n          cat,\n          _args = arguments;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              values = _args.length > 0 && _args[0] !== undefined ? _args[0] : [];\n              _context.prev = 1;\n              _context.next = 4;\n              return Axios({\n                baseURL: API,\n                url: \"/api/categories/getAll\",\n                method: \"GET\",\n                params: {\n                  nested: \"1\"\n                }\n              });\n\n            case 4:\n              values = _context.sent;\n              console.log(values);\n              all = [], product = [], service = [], names = [], subs = [];\n              cat = values.data.data.map(function (c) {\n                var _c$sub_categories;\n\n                if (c.type === \"product\" && c.parent_id) product.push(c);else if (c.type === \"service\" && c.parent_id) service.push(c);\n                if (((_c$sub_categories = c.sub_categories) === null || _c$sub_categories === void 0 ? void 0 : _c$sub_categories.length) >= 1) subs.push.apply(subs, _toConsumableArray(c.sub_categories));\n                all.push(c);\n                names[c.id] = c.name;\n              });\n              setCategories({\n                all: all,\n                product: product,\n                service: service,\n                subs: subs,\n                names: names\n              });\n              return _context.abrupt(\"return\", {\n                all: all,\n                product: product,\n                service: service,\n                subs: subs,\n                names: names\n              });\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](1);\n              console.log(_context.t0);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 12]]);\n    }));\n\n    return function getCategories() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getOrders = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res, values, newValues, oldVals;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return Axios({\n                baseURL: API,\n                url: \"/api/orders/get\",\n                method: \"GET\"\n              });\n\n            case 3:\n              res = _context2.sent;\n              values = res.data.data;\n              newValues = [];\n              oldVals = localStorage.getItem(\"ordersIDs\") ? JSON.parse(localStorage.getItem(\"ordersIDs\")) : [];\n              values.map(function (order) {\n                var hasNullableProducts = false;\n                order.Order_Products.map(function (product) {\n                  if (product.Product == null) hasNullableProducts = true;\n                });\n\n                if (hasNullableProducts == false && order.User != null) {\n                  if (!oldVals.includes(order.id)) {\n                    order[\"new\"] = true;\n                    oldVals.push(order.id);\n                  }\n\n                  newValues.push(order);\n                }\n              });\n              if (newValues[0][\"new\"]) setNewOrdersIndi(true);\n              setOrdersItems([].concat(newValues));\n              localStorage.setItem(\"ordersIDs\", JSON.stringify(oldVals));\n              _context2.next = 15;\n              break;\n\n            case 13:\n              _context2.prev = 13;\n              _context2.t0 = _context2[\"catch\"](0);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 13]]);\n    }));\n\n    return function getOrders() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var initailize = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setMainLoader(true);\n              _context3.prev = 1;\n              _context3.next = 4;\n              return getCategories();\n\n            case 4:\n              _context3.next = 6;\n              return getOrders();\n\n            case 6:\n              setMainLoader(false);\n              _context3.next = 12;\n              break;\n\n            case 9:\n              _context3.prev = 9;\n              _context3.t0 = _context3[\"catch\"](1);\n              console.log(_context3.t0.response);\n\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 9]]);\n    }));\n\n    return function initailize() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (userInfo.username) {\n      initailize();\n    } else {\n      var user = Cookies.get(\"user\");\n      if (user) setUserInfo(JSON.parse(user));\n    }\n  }, [userInfo]);\n  return (\n    /*#__PURE__*/\n    // return provider of the context with value object to be used wih all children components\n    _jsx(HelperContext.Provider, {\n      value: {\n        categories: categories,\n        setCategories: setCategories,\n        getCategories: getCategories,\n        ordersItems: ordersItems,\n        setOrdersItems: setOrdersItems,\n        newOrdersIndi: newOrdersIndi,\n        setNewOrdersIndi: setNewOrdersIndi,\n        mainLoader: mainLoader,\n        userInfo: userInfo,\n        setUserInfo: setUserInfo\n      },\n      children: children\n    })\n  );\n};","map":null,"metadata":{},"sourceType":"module"}